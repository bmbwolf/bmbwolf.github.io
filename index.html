<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="generator" content="Asciidoctor 0.1.4">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>磁盘操作</title>
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
article, aside, details, figcaption, figure, footer, header, hgroup, main, nav, section, summary { display: block; }
audio, canvas, video { display: inline-block; }
audio:not([controls]) { display: none; height: 0; }
[hidden] { display: none; }
html { background: #fff; color: #000; font-family: sans-serif; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; }
body { margin: 0; }
a:focus { outline: thin dotted; }
a:active, a:hover { outline: 0; }
h1 { font-size: 2em; margin: 0.67em 0; }
abbr[title] { border-bottom: 1px dotted; }
b, strong { font-weight: bold; }
dfn { font-style: italic; }
hr { -moz-box-sizing: content-box; box-sizing: content-box; height: 0; }
mark { background: #ff0; color: #000; }
code, kbd, pre, samp { font-family: monospace, serif; font-size: 1em; }
pre { white-space: pre-wrap; }
q { quotes: "\201C" "\201D" "\2018" "\2019"; }
small { font-size: 80%; }
sub, sup { font-size: 75%; line-height: 0; position: relative; vertical-align: baseline; }
sup { top: -0.5em; }
sub { bottom: -0.25em; }
img { border: 0; }
svg:not(:root) { overflow: hidden; }
figure { margin: 0; }
fieldset { border: 1px solid #c0c0c0; margin: 0 2px; padding: 0.35em 0.625em 0.75em; }
legend { border: 0; padding: 0; }
button, input, select, textarea { font-family: inherit; font-size: 100%; margin: 0; }
button, input { line-height: normal; }
button, select { text-transform: none; }
button, html input[type="button"], input[type="reset"], input[type="submit"] { -webkit-appearance: button; cursor: pointer; }
button[disabled], html input[disabled] { cursor: default; }
input[type="checkbox"], input[type="radio"] { box-sizing: border-box; padding: 0; }
input[type="search"] { -webkit-appearance: textfield; -moz-box-sizing: content-box; -webkit-box-sizing: content-box; box-sizing: content-box; }
input[type="search"]::-webkit-search-cancel-button, input[type="search"]::-webkit-search-decoration { -webkit-appearance: none; }
button::-moz-focus-inner, input::-moz-focus-inner { border: 0; padding: 0; }
textarea { overflow: auto; vertical-align: top; }
table { border-collapse: collapse; border-spacing: 0; }
*, *:before, *:after { -moz-box-sizing: border-box; -webkit-box-sizing: border-box; box-sizing: border-box; }
html, body { font-size: 100%; }
body { background: white; color: #222222; padding: 0; margin: 0; font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; font-weight: normal; font-style: normal; line-height: 1; position: relative; cursor: auto; }
a:hover { cursor: pointer; }
a:focus { outline: none; }
img, object, embed { max-width: 100%; height: auto; }
object, embed { height: 100%; }
img { -ms-interpolation-mode: bicubic; }
#map_canvas img, #map_canvas embed, #map_canvas object, .map_canvas img, .map_canvas embed, .map_canvas object { max-width: none !important; }
.left { float: left !important; }
.right { float: right !important; }
.text-left { text-align: left !important; }
.text-right { text-align: right !important; }
.text-center { text-align: center !important; }
.text-justify { text-align: justify !important; }
.hide { display: none; }
.antialiased, body { -webkit-font-smoothing: antialiased; }
img { display: inline-block; vertical-align: middle; }
textarea { height: auto; min-height: 50px; }
select { width: 100%; }
p.lead, .paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p { font-size: 1.21875em; line-height: 1.6; }
.subheader, #content #toctitle, .admonitionblock td.content > .title, .exampleblock > .title, .imageblock > .title, .videoblock > .title, .listingblock > .title, .literalblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, .sidebarblock > .title, .tableblock > .title, .verseblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title, .tableblock > caption { line-height: 1.4; color: #7a2518; font-weight: 300; margin-top: 0.2em; margin-bottom: 0.5em; }
div, dl, dt, dd, ul, ol, li, h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6, pre, form, p, blockquote, th, td { margin: 0; padding: 0; direction: ltr; }
a { color: #005498; text-decoration: underline; line-height: inherit; }
a:hover, a:focus { color: #00467f; }
a img { border: none; }
p { font-family: inherit; font-weight: normal; font-size: 1em; line-height: 1.6; margin-bottom: 1.25em; text-rendering: optimizeLegibility; }
p aside { font-size: 0.875em; line-height: 1.35; font-style: italic; }
h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { font-family: Georgia, "URW Bookman L", Helvetica, Arial, sans-serif; font-weight: normal; font-style: normal; color: #ba3925; text-rendering: optimizeLegibility; margin-top: 1em; margin-bottom: 0.5em; line-height: 1.2125em; }
h1 small, h2 small, h3 small, #toctitle small, .sidebarblock > .content > .title small, h4 small, h5 small, h6 small { font-size: 60%; color: #e99b8f; line-height: 0; }
h1 { font-size: 2.125em; }
h2 { font-size: 1.6875em; }
h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.375em; }
h4 { font-size: 1.125em; }
h5 { font-size: 1.125em; }
h6 { font-size: 1em; }
hr { border: solid #dddddd; border-width: 1px 0 0; clear: both; margin: 1.25em 0 1.1875em; height: 0; }
em, i { font-style: italic; line-height: inherit; }
strong, b { font-weight: bold; line-height: inherit; }
small { font-size: 60%; line-height: inherit; }
code { font-family: Consolas, "Liberation Mono", Courier, monospace; font-weight: normal; color: #6d180b; }
ul, ol, dl { font-size: 1em; line-height: 1.6; margin-bottom: 1.25em; list-style-position: outside; font-family: inherit; }
ul, ol { margin-left: 1.5em; }
ul li ul, ul li ol { margin-left: 1.25em; margin-bottom: 0; font-size: 1em; }
ul.square li ul, ul.circle li ul, ul.disc li ul { list-style: inherit; }
ul.square { list-style-type: square; }
ul.circle { list-style-type: circle; }
ul.disc { list-style-type: disc; }
ul.no-bullet { list-style: none; }
ol li ul, ol li ol { margin-left: 1.25em; margin-bottom: 0; }
dl dt { margin-bottom: 0.3125em; font-weight: bold; }
dl dd { margin-bottom: 1.25em; }
abbr, acronym { text-transform: uppercase; font-size: 90%; color: #222222; border-bottom: 1px dotted #dddddd; cursor: help; }
abbr { text-transform: none; }
blockquote { margin: 0 0 1.25em; padding: 0.5625em 1.25em 0 1.1875em; border-left: 1px solid #dddddd; }
blockquote cite { display: block; font-size: inherit; color: #555555; }
blockquote cite:before { content: "\2014 \0020"; }
blockquote cite a, blockquote cite a:visited { color: #555555; }
blockquote, blockquote p { line-height: 1.6; color: #6f6f6f; }
.vcard { display: inline-block; margin: 0 0 1.25em 0; border: 1px solid #dddddd; padding: 0.625em 0.75em; }
.vcard li { margin: 0; display: block; }
.vcard .fn { font-weight: bold; font-size: 0.9375em; }
.vevent .summary { font-weight: bold; }
.vevent abbr { cursor: auto; text-decoration: none; font-weight: bold; border: none; padding: 0 0.0625em; }
@media only screen and (min-width: 768px) { h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.4; }
  h1 { font-size: 2.75em; }
  h2 { font-size: 2.3125em; }
  h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.6875em; }
  h4 { font-size: 1.4375em; } }
.print-only { display: none !important; }
@media print { * { background: transparent !important; color: #000 !important; box-shadow: none !important; text-shadow: none !important; }
  a, a:visited { text-decoration: underline; }
  a[href]:after { content: " (" attr(href) ")"; }
  abbr[title]:after { content: " (" attr(title) ")"; }
  .ir a:after, a[href^="javascript:"]:after, a[href^="#"]:after { content: ""; }
  pre, blockquote { border: 1px solid #999; page-break-inside: avoid; }
  thead { display: table-header-group; }
  tr, img { page-break-inside: avoid; }
  img { max-width: 100% !important; }
  @page { margin: 0.5cm; }
  p, h2, h3, #toctitle, .sidebarblock > .content > .title { orphans: 3; widows: 3; }
  h2, h3, #toctitle, .sidebarblock > .content > .title { page-break-after: avoid; }
  .hide-on-print { display: none !important; }
  .print-only { display: block !important; }
  .hide-for-print { display: none !important; }
  .show-for-print { display: inherit !important; } }
table { background: white; margin-bottom: 1.25em; border: solid 1px #dddddd; }
table thead, table tfoot { background: whitesmoke; font-weight: bold; }
table thead tr th, table thead tr td, table tfoot tr th, table tfoot tr td { padding: 0.5em 0.625em 0.625em; font-size: inherit; color: #222222; text-align: left; }
table tr th, table tr td { padding: 0.5625em 0.625em; font-size: inherit; color: #222222; }
table tr.even, table tr.alt, table tr:nth-of-type(even) { background: #f9f9f9; }
table thead tr th, table tfoot tr th, table tbody tr td, table tr td, table tfoot tr td { display: table-cell; line-height: 1.6; }
.clearfix:before, .clearfix:after, .float-group:before, .float-group:after { content: " "; display: table; }
.clearfix:after, .float-group:after { clear: both; }
*:not(pre) > code { font-size: 0.9375em; padding: 1px 3px 0; white-space: nowrap; background-color: #f2f2f2; border: 1px solid #cccccc; -webkit-border-radius: 4px; border-radius: 4px; text-shadow: none; }
pre, pre > code { line-height: 1.4; color: inherit; font-family: Consolas, "Liberation Mono", Courier, monospace; font-weight: normal; }
kbd.keyseq { color: #555555; }
kbd:not(.keyseq) { display: inline-block; color: #222222; font-size: 0.75em; line-height: 1.4; background-color: #F7F7F7; border: 1px solid #ccc; -webkit-border-radius: 3px; border-radius: 3px; -webkit-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 2px white inset; box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 2px white inset; margin: -0.15em 0.15em 0 0.15em; padding: 0.2em 0.6em 0.2em 0.5em; vertical-align: middle; white-space: nowrap; }
kbd kbd:first-child { margin-left: 0; }
kbd kbd:last-child { margin-right: 0; }
.menuseq, .menu { color: #090909; }
p a > code:hover { color: #561309; }
#header, #content, #footnotes, #footer { width: 100%; margin-left: auto; margin-right: auto; margin-top: 0; margin-bottom: 0; max-width: 62.5em; *zoom: 1; position: relative; padding-left: 0.9375em; padding-right: 0.9375em; }
#header:before, #header:after, #content:before, #content:after, #footnotes:before, #footnotes:after, #footer:before, #footer:after { content: " "; display: table; }
#header:after, #content:after, #footnotes:after, #footer:after { clear: both; }
#header { margin-bottom: 2.5em; }
#header > h1 { color: black; font-weight: normal; border-bottom: 1px solid #dddddd; margin-bottom: -28px; padding-bottom: 32px; }
#header span { color: #6f6f6f; }
#header #revnumber { text-transform: capitalize; }
#header br { display: none; }
#header br + span { padding-left: 3px; }
#header br + span:before { content: "\2013 \0020"; }
#header br + span.author { padding-left: 0; }
#header br + span.author:before { content: ", "; }
#toc { border-bottom: 3px double #ebebeb; padding-bottom: 1.25em; }
#toc > ul { margin-left: 0.25em; }
#toc ul.sectlevel0 > li > a { font-style: italic; }
#toc ul.sectlevel0 ul.sectlevel1 { margin-left: 0; margin-top: 0.5em; margin-bottom: 0.5em; }
#toc ul { list-style-type: none; }
#toctitle { color: #7a2518; }
@media only screen and (min-width: 1280px) { body.toc2 { padding-left: 20em; }
  #toc.toc2 { position: fixed; width: 20em; left: 0; top: 0; border-right: 1px solid #ebebeb; border-bottom: 0; z-index: 1000; padding: 1em; height: 100%; overflow: auto; }
  #toc.toc2 #toctitle { margin-top: 0; }
  #toc.toc2 > ul { font-size: .95em; }
  #toc.toc2 ul ul { margin-left: 0; padding-left: 1.25em; }
  #toc.toc2 ul.sectlevel0 ul.sectlevel1 { padding-left: 0; margin-top: 0.5em; margin-bottom: 0.5em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 20em; }
  body.toc2.toc-right #toc.toc2 { border-right: 0; border-left: 1px solid #ebebeb; left: auto; right: 0; } }
#content #toc { border-style: solid; border-width: 1px; border-color: #d9d9d9; margin-bottom: 1.25em; padding: 1.25em; background: #f2f2f2; border-width: 0; -webkit-border-radius: 4px; border-radius: 4px; }
#content #toc > :first-child { margin-top: 0; }
#content #toc > :last-child { margin-bottom: 0; }
#content #toc a { text-decoration: none; }
#content #toctitle { font-weight: bold; font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; font-size: 1em; padding-left: 0.125em; }
#footer { max-width: 100%; background-color: #222222; padding: 1.25em; }
#footer-text { color: #dddddd; line-height: 1.44; }
.sect1 { padding-bottom: 1.25em; }
.sect1 + .sect1 { border-top: 3px double #ebebeb; }
#content h1 > a.anchor, h2 > a.anchor, h3 > a.anchor, #toctitle > a.anchor, .sidebarblock > .content > .title > a.anchor, h4 > a.anchor, h5 > a.anchor, h6 > a.anchor { position: absolute; width: 1em; margin-left: -1em; display: block; text-decoration: none; visibility: hidden; text-align: center; font-weight: normal; }
#content h1 > a.anchor:before, h2 > a.anchor:before, h3 > a.anchor:before, #toctitle > a.anchor:before, .sidebarblock > .content > .title > a.anchor:before, h4 > a.anchor:before, h5 > a.anchor:before, h6 > a.anchor:before { content: '\00A7'; font-size: .85em; vertical-align: text-top; display: block; margin-top: 0.05em; }
#content h1:hover > a.anchor, #content h1 > a.anchor:hover, h2:hover > a.anchor, h2 > a.anchor:hover, h3:hover > a.anchor, #toctitle:hover > a.anchor, .sidebarblock > .content > .title:hover > a.anchor, h3 > a.anchor:hover, #toctitle > a.anchor:hover, .sidebarblock > .content > .title > a.anchor:hover, h4:hover > a.anchor, h4 > a.anchor:hover, h5:hover > a.anchor, h5 > a.anchor:hover, h6:hover > a.anchor, h6 > a.anchor:hover { visibility: visible; }
#content h1 > a.link, h2 > a.link, h3 > a.link, #toctitle > a.link, .sidebarblock > .content > .title > a.link, h4 > a.link, h5 > a.link, h6 > a.link { color: #ba3925; text-decoration: none; }
#content h1 > a.link:hover, h2 > a.link:hover, h3 > a.link:hover, #toctitle > a.link:hover, .sidebarblock > .content > .title > a.link:hover, h4 > a.link:hover, h5 > a.link:hover, h6 > a.link:hover { color: #a53221; }
.imageblock, .literalblock, .listingblock, .verseblock, .videoblock { margin-bottom: 1.25em; }
.admonitionblock td.content > .title, .exampleblock > .title, .imageblock > .title, .videoblock > .title, .listingblock > .title, .literalblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, .sidebarblock > .title, .tableblock > .title, .verseblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { text-align: left; font-weight: bold; }
.tableblock > caption { text-align: left; font-weight: bold; white-space: nowrap; overflow: visible; max-width: 0; }
table.tableblock #preamble > .sectionbody > .paragraph:first-of-type p { font-size: inherit; }
.admonitionblock > table { border: 0; background: none; width: 100%; }
.admonitionblock > table td.icon { text-align: center; width: 80px; }
.admonitionblock > table td.icon img { max-width: none; }
.admonitionblock > table td.icon .title { font-weight: bold; text-transform: uppercase; }
.admonitionblock > table td.content { padding-left: 1.125em; padding-right: 1.25em; border-left: 1px solid #dddddd; color: #6f6f6f; }
.admonitionblock > table td.content > :last-child > :last-child { margin-bottom: 0; }
.exampleblock > .content { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: white; -webkit-border-radius: 4px; border-radius: 4px; }
.exampleblock > .content > :first-child { margin-top: 0; }
.exampleblock > .content > :last-child { margin-bottom: 0; }
.exampleblock > .content h1, .exampleblock > .content h2, .exampleblock > .content h3, .exampleblock > .content #toctitle, .sidebarblock.exampleblock > .content > .title, .exampleblock > .content h4, .exampleblock > .content h5, .exampleblock > .content h6, .exampleblock > .content p { color: #333333; }
.exampleblock > .content h1, .exampleblock > .content h2, .exampleblock > .content h3, .exampleblock > .content #toctitle, .sidebarblock.exampleblock > .content > .title, .exampleblock > .content h4, .exampleblock > .content h5, .exampleblock > .content h6 { line-height: 1; margin-bottom: 0.625em; }
.exampleblock > .content h1.subheader, .exampleblock > .content h2.subheader, .exampleblock > .content h3.subheader, .exampleblock > .content .subheader#toctitle, .sidebarblock.exampleblock > .content > .subheader.title, .exampleblock > .content h4.subheader, .exampleblock > .content h5.subheader, .exampleblock > .content h6.subheader { line-height: 1.4; }
.exampleblock.result > .content { -webkit-box-shadow: 0 1px 8px #d9d9d9; box-shadow: 0 1px 8px #d9d9d9; }
.sidebarblock { border-style: solid; border-width: 1px; border-color: #d9d9d9; margin-bottom: 1.25em; padding: 1.25em; background: #f2f2f2; -webkit-border-radius: 4px; border-radius: 4px; }
.sidebarblock > :first-child { margin-top: 0; }
.sidebarblock > :last-child { margin-bottom: 0; }
.sidebarblock h1, .sidebarblock h2, .sidebarblock h3, .sidebarblock #toctitle, .sidebarblock > .content > .title, .sidebarblock h4, .sidebarblock h5, .sidebarblock h6, .sidebarblock p { color: #333333; }
.sidebarblock h1, .sidebarblock h2, .sidebarblock h3, .sidebarblock #toctitle, .sidebarblock > .content > .title, .sidebarblock h4, .sidebarblock h5, .sidebarblock h6 { line-height: 1; margin-bottom: 0.625em; }
.sidebarblock h1.subheader, .sidebarblock h2.subheader, .sidebarblock h3.subheader, .sidebarblock .subheader#toctitle, .sidebarblock > .content > .subheader.title, .sidebarblock h4.subheader, .sidebarblock h5.subheader, .sidebarblock h6.subheader { line-height: 1.4; }
.sidebarblock > .content > .title { color: #7a2518; margin-top: 0; line-height: 1.6; }
.exampleblock > .content > :last-child > :last-child, .exampleblock > .content .olist > ol > li:last-child > :last-child, .exampleblock > .content .ulist > ul > li:last-child > :last-child, .exampleblock > .content .qlist > ol > li:last-child > :last-child, .sidebarblock > .content > :last-child > :last-child, .sidebarblock > .content .olist > ol > li:last-child > :last-child, .sidebarblock > .content .ulist > ul > li:last-child > :last-child, .sidebarblock > .content .qlist > ol > li:last-child > :last-child { margin-bottom: 0; }
.literalblock > .content pre, .listingblock > .content pre { background: none; border-width: 1px 0; border-style: dotted; border-color: #bfbfbf; -webkit-border-radius: 4px; border-radius: 4px; padding: 0.75em 0.75em 0.5em 0.75em; word-wrap: break-word; }
.literalblock > .content pre.nowrap, .listingblock > .content pre.nowrap { overflow-x: auto; white-space: pre; word-wrap: normal; }
.literalblock > .content pre > code, .listingblock > .content pre > code { display: block; }
@media only screen { .literalblock > .content pre, .listingblock > .content pre { font-size: 0.8em; } }
@media only screen and (min-width: 768px) { .literalblock > .content pre, .listingblock > .content pre { font-size: 0.9em; } }
@media only screen and (min-width: 1280px) { .literalblock > .content pre, .listingblock > .content pre { font-size: 1em; } }
.listingblock > .content { position: relative; }
.listingblock:hover code[class*=" language-"]:before { text-transform: uppercase; font-size: 0.9em; color: #999; position: absolute; top: 0.375em; right: 0.375em; }
.listingblock:hover code.asciidoc:before { content: "asciidoc"; }
.listingblock:hover code.clojure:before { content: "clojure"; }
.listingblock:hover code.css:before { content: "css"; }
.listingblock:hover code.groovy:before { content: "groovy"; }
.listingblock:hover code.html:before { content: "html"; }
.listingblock:hover code.java:before { content: "java"; }
.listingblock:hover code.javascript:before { content: "javascript"; }
.listingblock:hover code.python:before { content: "python"; }
.listingblock:hover code.ruby:before { content: "ruby"; }
.listingblock:hover code.scss:before { content: "scss"; }
.listingblock:hover code.xml:before { content: "xml"; }
.listingblock:hover code.yaml:before { content: "yaml"; }
.listingblock.terminal pre .command:before { content: attr(data-prompt); padding-right: 0.5em; color: #999; }
.listingblock.terminal pre .command:not([data-prompt]):before { content: '$'; }
table.pyhltable { border: 0; margin-bottom: 0; }
table.pyhltable td { vertical-align: top; padding-top: 0; padding-bottom: 0; }
table.pyhltable td.code { padding-left: .75em; padding-right: 0; }
.highlight.pygments .lineno, table.pyhltable td:not(.code) { color: #999; padding-left: 0; padding-right: .5em; border-right: 1px solid #dddddd; }
.highlight.pygments .lineno { display: inline-block; margin-right: .25em; }
table.pyhltable .linenodiv { background-color: transparent !important; padding-right: 0 !important; }
.quoteblock { margin: 0 0 1.25em; padding: 0.5625em 1.25em 0 1.1875em; border-left: 1px solid #dddddd; }
.quoteblock blockquote { margin: 0 0 1.25em 0; padding: 0 0 0.5625em 0; border: 0; }
.quoteblock blockquote > .paragraph:last-child p { margin-bottom: 0; }
.quoteblock .attribution { margin-top: -.25em; padding-bottom: 0.5625em; font-size: inherit; color: #555555; }
.quoteblock .attribution br { display: none; }
.quoteblock .attribution cite { display: block; margin-bottom: 0.625em; }
table thead th, table tfoot th { font-weight: bold; }
table.tableblock.grid-all { border-collapse: separate; border-spacing: 1px; -webkit-border-radius: 4px; border-radius: 4px; border-top: 1px solid #dddddd; border-bottom: 1px solid #dddddd; }
table.tableblock.frame-topbot, table.tableblock.frame-none { border-left: 0; border-right: 0; }
table.tableblock.frame-sides, table.tableblock.frame-none { border-top: 0; border-bottom: 0; }
table.tableblock td .paragraph:last-child p, table.tableblock td > p:last-child { margin-bottom: 0; }
th.tableblock.halign-left, td.tableblock.halign-left { text-align: left; }
th.tableblock.halign-right, td.tableblock.halign-right { text-align: right; }
th.tableblock.halign-center, td.tableblock.halign-center { text-align: center; }
th.tableblock.valign-top, td.tableblock.valign-top { vertical-align: top; }
th.tableblock.valign-bottom, td.tableblock.valign-bottom { vertical-align: bottom; }
th.tableblock.valign-middle, td.tableblock.valign-middle { vertical-align: middle; }
p.tableblock.header { color: #222222; font-weight: bold; }
td > div.verse { white-space: pre; }
ol { margin-left: 1.75em; }
ul li ol { margin-left: 1.5em; }
dl dd { margin-left: 1.125em; }
dl dd:last-child, dl dd:last-child > :last-child { margin-bottom: 0; }
ol > li p, ul > li p, ul dd, ol dd, .olist .olist, .ulist .ulist, .ulist .olist, .olist .ulist { margin-bottom: 0.625em; }
ul.unstyled, ol.unnumbered, ul.checklist, ul.none { list-style-type: none; }
ul.unstyled, ol.unnumbered, ul.checklist { margin-left: 0.625em; }
ul.checklist li > p:first-child > i[class^="icon-check"]:first-child, ul.checklist li > p:first-child > input[type="checkbox"]:first-child { margin-right: 0.25em; }
ul.checklist li > p:first-child > input[type="checkbox"]:first-child { position: relative; top: 1px; }
ul.inline { margin: 0 auto 0.625em auto; margin-left: -1.375em; margin-right: 0; padding: 0; list-style: none; overflow: hidden; }
ul.inline > li { list-style: none; float: left; margin-left: 1.375em; display: block; }
ul.inline > li > * { display: block; }
.unstyled dl dt { font-weight: normal; font-style: normal; }
ol.arabic { list-style-type: decimal; }
ol.decimal { list-style-type: decimal-leading-zero; }
ol.loweralpha { list-style-type: lower-alpha; }
ol.upperalpha { list-style-type: upper-alpha; }
ol.lowerroman { list-style-type: lower-roman; }
ol.upperroman { list-style-type: upper-roman; }
ol.lowergreek { list-style-type: lower-greek; }
.hdlist > table, .colist > table { border: 0; background: none; }
.hdlist > table > tbody > tr, .colist > table > tbody > tr { background: none; }
td.hdlist1 { padding-right: .8em; font-weight: bold; }
td.hdlist1, td.hdlist2 { vertical-align: top; }
.literalblock + .colist, .listingblock + .colist { margin-top: -0.5em; }
.colist > table tr > td:first-of-type { padding: 0 .8em; line-height: 1; }
.colist > table tr > td:last-of-type { padding: 0.25em 0; }
.qanda > ol > li > p > em:only-child { color: #00467f; }
.thumb, .th { line-height: 0; display: inline-block; border: solid 4px white; -webkit-box-shadow: 0 0 0 1px #dddddd; box-shadow: 0 0 0 1px #dddddd; }
.imageblock.left, .imageblock[style*="float: left"] { margin: 0.25em 0.625em 1.25em 0; }
.imageblock.right, .imageblock[style*="float: right"] { margin: 0.25em 0 1.25em 0.625em; }
.imageblock > .title { margin-bottom: 0; }
.imageblock.thumb, .imageblock.th { border-width: 6px; }
.imageblock.thumb > .title, .imageblock.th > .title { padding: 0 0.125em; }
.image.left, .image.right { margin-top: 0.25em; margin-bottom: 0.25em; display: inline-block; line-height: 0; }
.image.left { margin-right: 0.625em; }
.image.right { margin-left: 0.625em; }
a.image { text-decoration: none; }
span.footnote, span.footnoteref { vertical-align: super; font-size: 0.875em; }
span.footnote a, span.footnoteref a { text-decoration: none; }
#footnotes { padding-top: 0.75em; padding-bottom: 0.75em; margin-bottom: 0.625em; }
#footnotes hr { width: 20%; min-width: 6.25em; margin: -.25em 0 .75em 0; border-width: 1px 0 0 0; }
#footnotes .footnote { padding: 0 0.375em; line-height: 1.3; font-size: 0.875em; margin-left: 1.2em; text-indent: -1.2em; margin-bottom: .2em; }
#footnotes .footnote a:first-of-type { font-weight: bold; text-decoration: none; }
#footnotes .footnote:last-of-type { margin-bottom: 0; }
#content #footnotes { margin-top: -0.625em; margin-bottom: 0; padding: 0.75em 0; }
.gist .file-data > table { border: none; background: #fff; width: 100%; margin-bottom: 0; }
.gist .file-data > table td.line-data { width: 99%; }
div.unbreakable { page-break-inside: avoid; }
.big { font-size: larger; }
.small { font-size: smaller; }
.underline { text-decoration: underline; }
.overline { text-decoration: overline; }
.line-through { text-decoration: line-through; }
.aqua { color: #00bfbf; }
.aqua-background { background-color: #00fafa; }
.black { color: black; }
.black-background { background-color: black; }
.blue { color: #0000bf; }
.blue-background { background-color: #0000fa; }
.fuchsia { color: #bf00bf; }
.fuchsia-background { background-color: #fa00fa; }
.gray { color: #606060; }
.gray-background { background-color: #7d7d7d; }
.green { color: #006000; }
.green-background { background-color: #007d00; }
.lime { color: #00bf00; }
.lime-background { background-color: #00fa00; }
.maroon { color: #600000; }
.maroon-background { background-color: #7d0000; }
.navy { color: #000060; }
.navy-background { background-color: #00007d; }
.olive { color: #606000; }
.olive-background { background-color: #7d7d00; }
.purple { color: #600060; }
.purple-background { background-color: #7d007d; }
.red { color: #bf0000; }
.red-background { background-color: #fa0000; }
.silver { color: #909090; }
.silver-background { background-color: #bcbcbc; }
.teal { color: #006060; }
.teal-background { background-color: #007d7d; }
.white { color: #bfbfbf; }
.white-background { background-color: #fafafa; }
.yellow { color: #bfbf00; }
.yellow-background { background-color: #fafa00; }
span.icon > [class^="icon-"], span.icon > [class*=" icon-"] { cursor: default; }
.admonitionblock td.icon [class^="icon-"]:before { font-size: 2.5em; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5); cursor: default; }
.admonitionblock td.icon .icon-note:before { content: "\f05a"; color: #005498; color: #003f72; }
.admonitionblock td.icon .icon-tip:before { content: "\f0eb"; text-shadow: 1px 1px 2px rgba(155, 155, 0, 0.8); color: #111; }
.admonitionblock td.icon .icon-warning:before { content: "\f071"; color: #bf6900; }
.admonitionblock td.icon .icon-caution:before { content: "\f06d"; color: #bf3400; }
.admonitionblock td.icon .icon-important:before { content: "\f06a"; color: #bf0000; }
.conum { display: inline-block; color: white !important; background-color: #222222; -webkit-border-radius: 100px; border-radius: 100px; text-align: center; width: 20px; height: 20px; font-size: 12px; font-weight: bold; line-height: 20px; font-family: Arial, sans-serif; font-style: normal; position: relative; top: -2px; letter-spacing: -1px; }
.conum * { color: white !important; }
.conum + b { display: none; }
.conum:after { content: attr(data-value); }
.conum:not([data-value]):empty { display: none; }
.literalblock > .content > pre, .listingblock > .content > pre { -webkit-border-radius: 0; border-radius: 0; }

</style>
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>磁盘操作</h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_">1. 盘阵初始化</a></li>
<li>
<ul class="sectlevel2">
<li><a href="#_raid">1.1. RAID 控制器识别</a></li>
<li><a href="#__raid">1.2. 非RAID 控制器</a></li>
<li><a href="#__2">1.3. 管理工具使用</a></li>
<li><a href="#_lsi">1.4. LSI系列初始化</a></li>
<li><a href="#_adaptec">1.5. Adaptec系列初始化</a></li>
</ul>
</li>
<li><a href="#__3">2. 逻辑盘初始化</a></li>
<li>
<ul class="sectlevel2">
<li><a href="#__4">2.1. 分区</a></li>
<li><a href="#__5">2.2. 格式化</a></li>
<li><a href="#__fstab">2.3. 修改fstab</a></li>
<li><a href="#__6">2.4. 创建挂载点</a></li>
<li><a href="#__7">2.5. 挂载并修改目录权限</a></li>
<li><a href="#__8">2.6. 其他文件系统挂载</a></li>
</ul>
</li>
<li><a href="#__9">3. 故障处理</a></li>
<li>
<ul class="sectlevel2">
<li><a href="#_lsi_2">3.1. LSI系列坏盘</a></li>
<li><a href="#_adaptec_2">3.2. Adaptec系列坏盘</a></li>
<li><a href="#_scsi_hba">3.3. SCSI系列HBA卡坏盘</a></li>
<li><a href="#__10">3.4. 有坏快但盘还没坏的情况下换盘</a></li>
</ul>
</li>
<li><a href="#__11">4. 常见问题</a></li>
<li>
<ul class="sectlevel2">
<li><a href="#_lsi_3">4.1. LSI系列</a></li>
<li><a href="#_adaptec_3">4.2. Adaptec系列</a></li>
</ul>
</li>
<li><a href="#__12">5. 文件系统升级</a></li>
<li>
<ul class="sectlevel4">
<li><a href="#_ext3_ext4">ext3 升级到ext4 官方指南</a></li>
</ul>
</li>
<li><a href="#_nfs">6. NFS</a></li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_">1. 盘阵初始化</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_raid">1.1. RAID 控制器识别</h3>
<div class="ulist">
<ul>
<li>
<p>LSI系列的RAID卡控制器，使用<code>megacli</code>工具处理。</p>
<div class="listingblock">
<div class="content">
<pre>03:00.0 RAID bus controller: LSI Logic / Symbios Logic MegaRAID SAS 2108 [Liberator] (rev 05)</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
上面显示的是pci插槽信息，通过<code>lspci</code>命令可以获取。
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Adaptec系列RAID卡控制器，使用<code>arcconf</code>工具处理。</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>02:00.0 RAID bus controller: Adaptec AAC-RAID (rev 09)</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Compaq系列RAID卡控制器，使用<code>hpacucli</code>工具处理</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>02:01.0 RAID bus controller: Compaq Computer Corporation Smart Array 64xx (rev 01)</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Dell PowerEdge Expandabl系列RAID卡控制器，使用<code>megacli</code>工具处理。</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>02:0e.0 RAID bus controller: Dell PowerEdge Expandable RAID controller 5</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>DELL 某系列盘阵控制器，使用<code>omreport</code>工具</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="__raid">1.2. 非RAID 控制器</h3>
<div class="ulist">
<ul>
<li>
<p>Atto的SCSI控制器</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>05:00.0 Serial Attached SCSI controller: Atto Technology SAS Adapter</pre>
</div>
</div>
<div class="paragraph">
<p>看dmesg日志查看硬盘型号</p>
</div>
<div class="listingblock">
<div class="content">
<pre>grep -i "ata\|scsi" dmesg.0</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>SCSI控制器相关硬盘信息查看</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>sudo lsscsi

 [0:0:0:0]    cd/dvd  Dell     Virtual  CDROM   123   /dev/scd0
 [1:0:0:0]    disk    Dell     Virtual  Floppy  123   /dev/sdc
 [2:0:0:0]    disk    ATA      Maxtor 7L250S0   1G10  /dev/sda
 [2:0:4:0]    disk    SEAGATE  ST3300555SS      T105  /dev/sdb</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>cat /proc/scsi/scsi

 Attached devices:
 Host: scsi2 Channel: 00 Id: 00 Lun: 00
   Vendor: ATA      Model: Maxtor 7L250S0   Rev: 1G10
   Type:   Direct-Access                    ANSI SCSI revision: 05
 Host: scsi0 Channel: 00 Id: 00 Lun: 00
   Vendor: Dell     Model: Virtual  CDROM   Rev: 123
   Type:   CD-ROM                           ANSI SCSI revision: 02
 Host: scsi1 Channel: 00 Id: 00 Lun: 00
   Vendor: Dell     Model: Virtual  Floppy  Rev: 123
   Type:   Direct-Access                    ANSI SCSI revision: 02
 Host: scsi2 Channel: 00 Id: 04 Lun: 00
   Vendor: SEAGATE  Model: ST3300555SS      Rev: T105
   Type:   Direct-Access                    ANSI SCSI revision: 05</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>sudo smartctl -a /dev/sda

 === START OF INFORMATION SECTION ===
 Model Family:     Maxtor MaXLine III family (ATA/133 and SATA/150)
 Device Model:     Maxtor 7L250S0</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>sudo smartctl -a /dev/sdb

 Device: SEAGATE  ST3300555SS      Version: T105
 Serial number: 3LM09L9B</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="__2">1.3. 管理工具使用</h3>
<div class="ulist">
<ul>
<li>
<p>megacli/megactl/megasasctl</p>
<div class="paragraph">
<p>RAID卡电池查看</p>
</div>
<div class="listingblock">
<div class="content">
<pre>sudo megacli -AdpBbuCmd -GetBbuDesignInfo -aALL

BBU Design Info for Adapter: 0
Date of Manufacture: 08/10, 2011
Design Capacity: 1700 mAh
Design Voltage: 3700 mV
Specification Info: 33
Serial Number: 2020
Pack Stat Configuration: 0x0000
Manufacture Name: SANYO
Device Name: DLNU209
Device Chemistry: LION
Battery FRU: N/A
Transparent Learn = 0
App Data = 0
Exit Code: 0x00</pre>
</div>
</div>
<div class="paragraph">
<p>RAID 卡电池相关信息查看</p>
</div>
<div class="listingblock">
<div class="content">
<pre>megaCli -AdpBbuCmd -GetBbuStatus -aALL |grep 'Charger Status'    [查看充电状态]

`megaCli -AdpBbuCmd -GetBbuStatus -aALL`    [显示BBU状态信息]

`megaCli -AdpBbuCmd -GetBbuCapacityInfo -aALL`    [显示BBU容量信息]

`megaCli -AdpBbuCmd -GetBbuDesignInfo -aALL`    [显示BBU设计参数]

`megaCli -AdpBbuCmd -GetBbuProperties -aALL`    [显示当前BBU属性]</pre>
</div>
</div>
</li>
<li>
<p>arcconf</p>
</li>
<li>
<p>hpacucli</p>
<div class="listingblock">
<div class="content">
<pre>sudo hpacucli ctrl all show config detail</pre>
</div>
</div>
</li>
<li>
<p>omreport</p>
<div class="listingblock">
<div class="content">
<pre>sudo omreport storage pdisk controller=0
sudo omreport storage vdisk controller=0</pre>
</div>
</div>
</li>
<li>
<p>smartctl</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_lsi">1.4. LSI系列初始化</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<code>megasasctl/megactl</code>工具能比较直观的获取到<code>Enclosure Device ID</code>和<code>Slot Number</code>信息,这两个信息就是盘阵信息和插槽信息。
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>获取磁盘信息</p>
<div class="paragraph">
<p><code>sudo megasasctl</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre>a0       PERC H700 Integrated     encl:1 ldrv:1  batt:good
a0d0      1675GiB RAID 10  3x2  optimal
a0e32s0     558GiB  a0d0  online
a0e32s1     558GiB  a0d0  online
a0e32s2     558GiB  a0d0  online
a0e32s3     558GiB  a0d0  online
a0e32s4     558GiB  a0d0  online
a0e32s5     558GiB  a0d0  online</pre>
</div>
</div>
</li>
<li>
<p>盘阵处理</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>单盘RAID 0</p>
<div class="literalblock">
<div class="content">
<pre>megacli -CfgLdAdd -r0[E0:S0] -a0</pre>
</div>
</div>
</li>
<li>
<p>双盘RAID 1</p>
</li>
<li>
<p>多盘RAID 6</p>
<div class="listingblock">
<div class="content">
<pre>megacli -CfgLdAdd -r6[17:0,17:1,17:2,17:3,17:4,17:5,17:6,17:7,17:8,17:9,17:10,17:11,17:12,17:13,17:14] -a0</pre>
</div>
</div>
</li>
<li>
<p>多盘RAID 5</p>
</li>
<li>
<p>多盘RAID 10</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>2x2 做的RAID 10</p>
<div class="listingblock">
<div class="content">
<pre>a0d1      1862GiB RAID 10  2x2  optimal</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>megacli -CfgSpanAdd -r10 -Array0[32:2,32:3] -Array1[32:4,32:5] -a0`</pre>
</div>
</div>
</li>
<li>
<p>4x2 做的RAID 10</p>
<div class="listingblock">
<div class="content">
<pre>a0d1      2233GiB RAID 10  4x2  optimal</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>megacli -CfgSpanAdd -r10 -Array0[32:2,32:3] -Array1[32:4,32:5] -Array3[32:6,32:7] -Array4[32:8,32:9] -a0</pre>
</div>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_adaptec">1.5. Adaptec系列初始化</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Reported Channel,Device编号是识别识别物理磁盘的依据，都是唯一的。通过<code>arcconf getconfig 1 pd</code>能够获取。可以参考<code>arcconf create -h</code>。
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>获取磁盘信息</p>
<div class="paragraph">
<p><code>sudo arcconf getconfig 1 pd</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre>Device #0
   Device is a Hard drive
   State                              : Online
   Supported                          : Yes
   Transfer Speed                     : SATA0 Gb/s
   Reported Channel,Device(T:L)       : 0,8(8:0)  #获取编号
   Reported Location                  : Enclosure 0, Slot 0
   Reported ESD(T:L)                  : 2,0(0:0)
   Vendor                             : Hitachi
   Model                              : HDS722020ALA330
   Firmware                           : JKAOA3EA
   Serial number                      : JK11A4B8KBT5YW
   Size                               : 1907729 MB
   Write Cache                        : Enabled (write-back)
   FRU                                : None
   S.M.A.R.T.                         : No
   S.M.A.R.T. warnings                : 0
   Power State                        : Full rpm
   Supported Power States             : Full rpm,Powered off,Reduced rpm
   SSD                                : No
   MaxCache Capable                   : No
   MaxCache Assigned                  : No
   NCQ status                         : Enabled</pre>
</div>
</div>
</li>
<li>
<p>盘阵处理</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>单盘RAID 0</p>
<div class="listingblock">
<div class="content">
<pre>sudo arcconf create 1 logicaldrive max volume 0 31 noprompt</pre>
</div>
</div>
</li>
<li>
<p>多盘RAID 60</p>
<div class="listingblock">
<div class="content">
<pre>arcconf create 1 LOGICALDRIVE MAX 60 0 8 0 9 0 10 0 11 0 12 0 13 0 14 0 15 0 16 0 17 0 18 0 19 0 20 0 21 0 22 0 23 0 24 0 25 0 26 0 27 0 28 0 29 0 30 0 31 noprompt</pre>
</div>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="__3">2. 逻辑盘初始化</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="__4">2.1. 分区</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
MBR分区表只支持最大为2TB的分区，2TB以上的分区使用GPT分区表。当然2TB以下的分区也是可以使用GPT分区的。
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>cfdisk/fdisk</p>
</li>
<li>
<p>parted</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>选择分区表</p>
<div class="paragraph">
<p><code>sudo parted -s /dev/sdb mklabel gpt</code></p>
</div>
</li>
<li>
<p>创建分区</p>
<div class="paragraph">
<p><code>sudo parted -s -- /dev/sdb mkpart primary 0 -1s</code></p>
</div>
<div class="paragraph">
<p><code>parted -s -- /dev/sda mkpart primary 0 100%</code></p>
</div>
</li>
<li>
<p><strong>修改分区表并分区</strong></p>
<div class="paragraph">
<p><code>sudo parted -s /dev/sda -- mklabel gpt mkpart primary 0 -1</code></p>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>partprobe/partx</p>
</li>
<li>
<p>testdisk恢复分区表</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="__5">2.2. 格式化</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
mkfs.ext3/ext4支持格式化的时候指定UUID，而mkfs.xfs格式化的时候不支持指定UUID，只能通过xfs_admin手工修改UUID。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>sudo xfs_admin -U cd1b9cdb-fa95-4bbe-9a93-57196ec5510c /dev/sdg1</code></p>
</div>
</div>
<div class="sect2">
<h3 id="__fstab">2.3. 修改fstab</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
磁盘挂载一般通过UUID的方式挂载，不建议通过设备名挂载，因为UUID是唯一的，系统重启的时候设备名会变而UUID是不会变的。
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="__6">2.4. 创建挂载点</h3>

</div>
<div class="sect2">
<h3 id="__7">2.5. 挂载并修改目录权限</h3>
<div class="paragraph">
<p><code>mount -a</code></p>
</div>
<div class="paragraph">
<p><code>chown root.root /srv/0</code></p>
</div>
</div>
<div class="sect2">
<h3 id="__8">2.6. 其他文件系统挂载</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>内存文件系统的挂载</p>
<div class="paragraph">
<p><code>mount -t tmpfs -o nosuid,nodev,size=10G,mode=1777 tmpfs /mnt/</code></p>
</div>
</li>
<li>
<p>挂载移动硬盘</p>
<div class="paragraph">
<p><code>mount -t ntfs -o uid=music,gid=netease,fmask=133,dmask=022 /dev/sdz1 /mnt/usb/</code></p>
</div>
</li>
<li>
<p>bind 的用法</p>
<div class="listingblock">
<div class="content">
<pre>/vicepa/unfs /home/unfs none defaults,bind 0 0
/vicepa/dfs /home/dfs none defaults,bind 0 0</pre>
</div>
</div>
</li>
<li>
<p>挂载nobarrier</p>
<div class="listingblock">
<div class="content">
<pre>/dev/sdb1 on /mnt/ndir type xfs (rw,noatime,attr2,delaylog,noquota)

UUID=74e18540-397a-469d-9599-3e404ca23ed2	/mnt/ndir	xfs	noatime,nobarrier	0 	0

/dev/sdb1 on /mnt/ndir type xfs (rw,noatime,attr2,delaylog,nobarrier,noquota)</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="__9">3. 故障处理</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_lsi_2">3.1. LSI系列坏盘</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>查看dmesg信息</p>
</li>
<li>
<p>查看挂点信息，看目录能否读写，目录是否被占用</p>
<div class="paragraph">
<p><code>sudo fuser -mv /srv</code></p>
</div>
</li>
<li>
<p>umount目录</p>
</li>
<li>
<p>查看坏盘</p>
<div class="paragraph">
<p><code>megasasctl</code> 或 <code>megactl</code></p>
</div>
</li>
<li>
<p>联系机房换盘</p>
</li>
<li>
<p>新盘初始化</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_adaptec_2">3.2. Adaptec系列坏盘</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>查看dmesg信息，是否有offline信息</p>
</li>
<li>
<p>查看挂点信息，看目录能否读写，目录是否被占用</p>
<div class="paragraph">
<p><code>fuser</code> or <code>losf</code></p>
</div>
</li>
<li>
<p>umount目录</p>
</li>
<li>
<p>查看坏盘</p>
<div class="paragraph">
<p><code>sudo arcconf getconfig 1 pd|grep "Slot"</code></p>
</div>
</li>
<li>
<p>联系机房换盘</p>
</li>
<li>
<p>新盘初始化</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_scsi_hba">3.3. SCSI系列HBA卡坏盘</h3>

</div>
<div class="sect2">
<h3 id="__10">3.4. 有坏快但盘还没坏的情况下换盘</h3>
<div class="ulist">
<ul>
<li>
<p>LSI系列</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>定位有坏道的物理盘</p>
<div class="paragraph">
<p>通过 <code>megasasctl</code> 或 <code>sudo megacli -CfgDsply -a0</code></p>
</div>
<div class="paragraph">
<p>查看有坏道的物理磁盘。搜索 'Media Error Count'</p>
</div>
</li>
<li>
<p>定位物理盘所在的逻辑盘</p>
<div class="paragraph">
<p><code>sudo megacli -CfgDsply -a0</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre>// 下面这行就是
Virtual Drive: 1 (Target Id: 1)</pre>
</div>
</div>
</li>
<li>
<p>offline 逻辑盘</p>
<div class="paragraph">
<p><code>sudo megacli -CfgLdDel -L1 -a0</code></p>
</div>
</li>
<li>
<p>定位坏盘，使之亮灯，让机房识别</p>
<div class="paragraph">
<p>定位某块磁盘(通过控制盘阵上对应的指示灯)</p>
</div>
<div class="paragraph">
<p><code>sudo megacli -PdLocate -start -PhysDrv[0:5] -a0</code> // 0:5 是要定位的磁盘的 Enclosure ID 和 Slot Number</p>
</div>
<div class="paragraph">
<p><code>sudo megacli -PDOffline -PhysDrv[21:0] -a0</code></p>
</div>
</li>
<li>
<p>机房处理</p>
</li>
<li>
<p>umount 坏盘分区</p>
</li>
<li>
<p>新盘初始化</p>
</li>
</ol>
</div>
</li>
<li>
<p>Adaptec系列</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>umount 坏盘分区</p>
</li>
<li>
<p>辨别有问题的逻辑盘</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
arcconf 不能删除已经挂载的磁盘logicaldrive，已经挂载的磁盘删除logicaldrive设备会报错
</td>
</tr>
</table>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>mount状态</p>
<div class="paragraph">
<p><code>sudo arcconf  delete 1 logicaldrive 15</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre>Controllers found: 1
Logical device 15 is mounted on /mnt/dfs/15 and cannot be deleted.
Command aborted.</pre>
</div>
</div>
</li>
<li>
<p>umount状态</p>
<div class="paragraph">
<p><code>sudo arcconf delete 1 logicaldrive 14</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre>Controllers found: 1

WARNING: logical device 14 may contain a partition.
All data in logical device 14 will be lost.
Delete the logical device?
Press y, then ENTER to continue or press ENTER to abort:</pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>给坏盘亮灯</p>
<div class="paragraph">
<p><code>sudo arcconf IDENTIFY 1 LOGICALDRIVE 14</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre>Controllers found: 1
The specified device is blinking.
Press any key to stop the blinking.</pre>
</div>
</div>
</li>
<li>
<p>机房换盘</p>
</li>
<li>
<p>新盘初始化</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="__11">4. 常见问题</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_lsi_3">4.1. LSI系列</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>创建vdisk的时候出现以下问题</p>
<div class="paragraph">
<p><code>sudo megacli -CfgLdAdd -r0[17:6] -a0</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre>Adapter 0: Configure Adapter Failed
FW error description:
The current operation is not allowed because the controller has data in cache for offline or missing virtual drives.
Exit Code: 0x54</pre>
</div>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>解决方法:</p>
<div class="paragraph">
<p><code>sudo megacli -GetPreservedCacheList -a0</code></p>
</div>
<div class="paragraph">
<p><code>sudo megacli -DiscardPreservedCache -L6 -a0</code></p>
</div>
</li>
<li>
<p>效果如下:</p>
<div class="paragraph">
<p><code>sudo megacli -GetPreservedCacheList -a0</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre>Adapter #0
Virtual Drive(Target ID 06): Missing.
Exit Code: 0x00</pre>
</div>
</div>
<div class="paragraph">
<p><code>sudo megacli -DiscardPreservedCache -L6 -a0</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre>Adapter #0
Virtual Drive(Target ID 06): Preserved Cache Data Cleared.
Exit Code: 0x00</pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>新换硬盘状态是JBOD状态，导致创建vdisk失败</p>
<div class="paragraph">
<p><code>sudo megacli -CfgLdAdd -r0[21:7] -a0</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre>The specified physical disk does not have the appropriate attributes to complete the requested command.
Exit Code: 0x26</pre>
</div>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>查看硬盘JBOD状态</p>
<div class="paragraph">
<p><code>sudo megacli -PDList -a0|less|grep JBOD</code></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
新换硬盘状态是JBOD状态，导致创建vdisk失败
</td>
</tr>
</table>
</div>
</li>
<li>
<p>解决方法:</p>
<div class="paragraph">
<p><code>sudo megacli -PDMakeGood -PhysDrv[21:7] -force -a0</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre>Adapter: 0: EnclId-21 SlotId-7 state changed to Unconfigured-Good.
Exit Code: 0x00</pre>
</div>
</div>
<div class="paragraph">
<p><code>sudo megacli -CfgLdAdd -r0[21:7] -a0</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre>Adapter 0: Created VD 8
Adapter 0: Configured the Adapter!!
Exit Code: 0x00</pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>megacli管理工具清理<code>Cache</code>异常报错，不能清理<code>Cache</code>，联系机房手工处理</p>
<div class="paragraph">
<p><code>sudo megacli -DiscardPreservedCache -L5 -a0</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre>Adapter #0
Segmentation fault</pre>
</div>
</div>
</li>
<li>
<p>设置RAID卡cache策略</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>查看RAID cache状态</p>
<div class="paragraph">
<p><code>sudo megacli -LDGetProp -Cache -Lall -a0</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre>Adapter 0-VD 0(target id: 0): Cache Policy:WriteThrough, ReadAdaptive, Direct, No Write Cache if bad BBU
Adapter 0-VD 1(target id: 1): Cache Policy:WriteThrough, ReadAdaptive, Direct, No Write Cache if bad BBU
Adapter 0-VD 2(target id: 2): Cache Policy:WriteBack, ReadAdaptive, Direct, Write Cache OK if bad BBU
Exit Code: 0x00</pre>
</div>
</div>
</li>
<li>
<p>设置RAID卡cache策略</p>
<div class="paragraph">
<p><code>sudo megacli -LDSetProp ForcedWB -L2 -a0</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre>Set Write Policy to Forced WriteBack on Adapter 0, VD 2 (target id: 2) success
Exit Code: 0x00</pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
cache 策略如果在RAID卡电池出现问题的时候，强制设为ForcedWB的情况下面，存在很多风险，当机器挂了或者断电的情况下面，cache中的数据就没法刷回磁盘，这样就存在数据丢失的情况。 这是一种牺牲安全换取性能的做法，不值得推荐。
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>查看intel ssd的寿命&#8201;&#8212;&#8201;LSI 的RAID卡</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>思路：</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>通过获取Slot Number</p>
<div class="paragraph">
<p><code>sudo megacli -pdlist -a0</code> 或</p>
</div>
<div class="paragraph">
<p><code>sudo megasasctl -v</code></p>
</div>
</li>
<li>
<p>通过smatctl 获取ssd寿命信息</p>
<div class="paragraph">
<p><code>sudo smartctl -a -d megaRAID,8 /dev/sdd</code></p>
</div>
<div class="paragraph">
<p>表示<code>Slot Number: 8</code>, 设备符为<code>/dev/sdd</code>获取到的smart信息</p>
</div>
<div class="listingblock">
<div class="content">
<pre>SMART Attributes Data Structure revision number: 1
Vendor Specific SMART Attributes with Thresholds:
ID# ATTRIBUTE_NAME          FLAG     VALUE WORST THRESH TYPE      UPDATED  WHEN_FAILED RAW_VALUE
  5 Reallocated_Sector_Ct   0x0032   096   096   000    Old_age   Always       -       0
  9 Power_On_Hours          0x0032   100   100   000    Old_age   Always       -       544
 12 Power_Cycle_Count       0x0032   100   100   000    Old_age   Always       -       9
170 Unknown_Attribute       0x0033   100   100   010    Pre-fail  Always       -       0
171 Unknown_Attribute       0x0032   100   100   000    Old_age   Always       -       0
172 Unknown_Attribute       0x0032   100   100   000    Old_age   Always       -       0
174 Unknown_Attribute       0x0032   100   100   000    Old_age   Always       -       6
175 Program_Fail_Count_Chip 0x0033   100   100   010    Pre-fail  Always       -       13044744823
183 Runtime_Bad_Block       0x0032   100   100   000    Old_age   Always       -       0
184 End-to-End_Error        0x0033   100   100   090    Pre-fail  Always       -       0
187 Reported_Uncorrect      0x0032   100   100   000    Old_age   Always       -       0
190 Airflow_Temperature_Cel 0x0022   084   071   000    Old_age   Always       -       16 (Min/Max 10/29)
192 Power-Off_Retract_Count 0x0032   100   100   000    Old_age   Always       -       6
194 Temperature_Celsius     0x0022   100   100   000    Old_age   Always       -       16
197 Current_Pending_Sector  0x0032   100   100   000    Old_age   Always       -       0
199 UDMA_CRC_Error_Count    0x003e   100   100   000    Old_age   Always       -       0
225 Load_Cycle_Count        0x0032   100   100   000    Old_age   Always       -       357286
226 Load-in_Time            0x0032   100   100   000    Old_age   Always       -       849
227 Torq-amp_Count          0x0032   100   100   000    Old_age   Always       -       50
228 Power-off_Retract_Count 0x0032   100   100   000    Old_age   Always       -       12518
232 Available_Reservd_Space 0x0033   100   100   010    Pre-fail  Always       -       0
233 Media_Wearout_Indicator 0x0032   100   100   000    Old_age   Always       -       0
234 Unknown_Attribute       0x0032   100   100   000    Old_age   Always       -       0</pre>
</div>
</div>
</li>
<li>
<p>获取需要的数据信息</p>
<div class="listingblock">
<div class="content">
<pre>233 Media_Wearout_Indicator 0x0032   100   100   000    Old_age   Always       -       0</pre>
</div>
</div>
<div class="paragraph">
<p>100   100 表示没有损耗，随着损耗的增加数字递减，当数字降为1时便不再下降，这块ssd便寿终啦。</p>
</div>
</li>
<li>
<p>参考</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><a href="http://hatemysql.com/2011/03/08/%E5%88%A9%E7%94%A8megacli%E5%92%8Csmartctl%E5%B7%A5%E5%85%B7%E8%8E%B7%E5%BE%97ssd%E7%9B%98%E4%BD%BF%E7%94%A8%E6%83%85%E5%86%B5/">利用MegaCli和smartCtl工具获得ssd盘使用情况</a></p>
</div>
<div class="paragraph">
<p><a href="http://blog.yufeng.info/archives/1096">smartctl获取RAID卡下intel ssd寿命</a></p>
</div>
</div>
<div class="sect2">
<h3 id="_adaptec_3">4.2. Adaptec系列</h3>
<div class="sect4">
<h5 id="__raid_2">提取RAID卡信息给厂商</h5>
<div class="literalblock">
<div class="content">
<pre>sudo arcconf SAVESUPPORTARCHIVE
tar -zpcv -f Support.tar.gz /var/log/Support/</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="__12">5. 文件系统升级</h2>
<div class="sectionbody">
<div class="sect4">
<h5 id="_ext3_ext4">ext3 升级到ext4 官方指南</h5>
<div class="paragraph">
<p><a href="http://www.debian-administration.org/article/643/Migrating_a_live_system_from_ext3_to_ext4_filesystem">Migrating_a_live_system_from_ext3_to_ext4_filesystem</a></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_nfs">6. NFS</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>nfs搭建</p>
<div class="listingblock">
<div class="content">
<pre>ii  nfs-common	1:1.2.2-4squeeze2	NFS support files common to client and server
ii  nfs-kernel-server	1:1.2.2-4squeeze2	support for NFS kernel server</pre>
</div>
</div>
<div class="paragraph">
<p><code>cat /etc/exports</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre>/mnt/nfs *(rw,all_squash,anonuid=65534,anongid=65534,no_subtree_check)</pre>
</div>
</div>
<div class="paragraph">
<p><code>sudo /etc/init.d/nfs-kernel-server restart</code></p>
</div>
</li>
<li>
<p>检查下是否有问题</p>
<div class="paragraph">
<p><code>showmount -e</code></p>
</div>
</li>
<li>
<p>clients的挂法</p>
<div class="literalblock">
<div class="content">
<pre>10.131.3.7:/mnt/nfs /nfs    nfs     nfsvers=3,proto=tcp,rsize=8192,wsize=8192,hard,intr     0 3</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2014-07-09 14:20:11 CST
</div>
</div>
</body>
</html>